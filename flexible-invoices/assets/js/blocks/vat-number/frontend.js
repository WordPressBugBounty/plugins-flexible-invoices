(()=>{var e={184:(e,t)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var c=typeof r;if("string"===c||"number"===c)e.push(r);else if(Array.isArray(r)){if(r.length){var a=s.apply(null,r);a&&e.push(a)}}else if("object"===c)if(r.toString===Object.prototype.toString)for(var o in r)n.call(r,o)&&r[o]&&e.push(o);else e.push(r.toString())}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0===(r=function(){return s}.apply(t,[]))||(e.exports=r)}()}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var c=t[n]={exports:{}};return e[n](c,c.exports,r),c.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.wp.element,t=window.wc.blocksCheckout,n=window.wp.i18n,s=JSON.parse('{"apiVersion":2,"name":"woocommerce/eu-vat-number","version":"1.0.0","title":"Vat Number","parent":["woocommerce/checkout-fields-block"],"category":"woocommerce","icon":"cart","description":"","supports":{"html":false},"textdomain":"woocommerce-eu-vat-number","attributes":{"lock":{"type":"object","default":{"remove":true,"move":false}}}}'),c=window.wp.compose,a=window.wc.wcSettings;var o=r(184),i=r.n(o);const l=(e,t)=>{const r={AT:/^(AT)?U[A-Z\d]{8}$/,BE:/^(BE)?0\d{9}$/,BG:/^(BG)?\d{9,10}$/,CY:/^(CY)?\d{8}[A-Z]$/,CZ:/^(CZ)?\d{8,10}$/,DE:/^(DE)?\d{9}$/,DK:/^(DK)?(\d{2} ?){3}\d{2}$/,EE:/^(EE)?\d{9}$/,EL:/^(EL)?\d{9}$/,ES:/^(ES)?[A-Z]\d{7}[A-Z]|\d{8}[A-Z]|[A-Z]\d{8}$/,FI:/^(FI)?\d{8}$/,FR:/^(FR)?([A-Z]{2}|[A-Z0-9]{2})?\d{9}$/,XI:/^(XI)?\d{9}|\d{12}|(GD|HA)\d{3}$/,HR:/^(HR)?\d{11}$/,HU:/^(HU)?\d{8}$/,IE:/^(IE)?[A-Z\d]{8,10}$/,IT:/^(IT)?\d{11}$/,LT:/^(LT)?(\d{9}|\d{12})/,LU:/^(LU)?\d{8}$/,LV:/^(LV)?\d{11}$/,MT:/^(MT)?\d{8}$/,NL:/^(NL)?\d{9}B\d{2}$/,PL:/^(PL)?\d{10}$/,PT:/^(PT)?\d{9}$/,RO:/^(RO)?\d{2,10}$/,SE:/^(SE)?\d{12}$/,SI:/^(SI)?\d{8}$/,SK:/^(SK)?\d{10}$/};if(r[e]){let n=r[e];return"PL"===e?n.test(t)&&function(e){const t=[6,5,7,2,3,4,5,6,7];let r=0;for(let n=0;n<9;n++)r+=t[n]*e[n];let n=r%11;return(10===n?0:n)===parseInt(e[9])}(t):n.test(t)}return!0},u=e=>{switch(e){case"AT":return"ATU12345678";case"BE":return"BE123456789 / BE0123456789";case"BG":return"BG123456789 / BG0123456789";case"CY":return"CY12345678X";case"CZ":return"CZ12345678 / CZ123456789 / CZ1234567890";case"DE":return"DE123456789";case"DK":return"DK12345678";case"EE":return"EE123456789";case"GR":case"EL":return"EL123456789";case"ES":return"ESX12345678 / ES12345678X / ESX1234567X";case"EU":return"EU123456789";case"FI":return"FI12345678";case"FR":return"FR12345678901 / FRX1234567890 / FR1X123456789 / FRXX123456789";case"GB":return"GB123456789";case"HR":return"HR12345678901";case"HU":return"HU12345678";case"IE":return"IE1234567WA / IE1234567FA";case"IT":return"IT12345678901";case"LV":return"LV12345678901";case"LT":return"LT123456789 / LT123456789012 ";case"LU":return"LU12345678";case"MT":return"MT12345678";case"NL":return"NL123456789B01";case"NO":return"NO123456789";case"PL":return"1234567890";case"PT":return"PT123456789";case"RO":return"RO1234567890";case"RS":return"RS123456789";case"SI":return"SI12345678";case"SK":return"SK1234567890";case"SE":return"SE123456789012";default:return""}},d=({defaultTitle:e="",defaultDescription:t="",defaultShowStepNumber:r=!0})=>({title:{type:"string",default:e},description:{type:"string",default:t},showStepNumber:{type:"boolean",default:r}}),m=({title:t,stepHeadingContent:r})=>(0,e.createElement)("div",{className:"wc-block-components-checkout-step__heading"},(0,e.createElement)("h2",{"aria-hidden":"true",className:"wc-block-components-checkout-step__title wc-block-components-title"},t),!!r&&(0,e.createElement)("span",{className:"wc-block-components-checkout-step__heading-content"},r)),p=(b=d({}),t=>r=>{const n=((e,t)=>{const r=[];return Object.keys(e).forEach((n=>{if(void 0!==t[n])switch(e[n].type){case"boolean":r[n]="false"!==t[n]&&!1!==t[n];break;case"number":r[n]=parseInt(t[n],10);break;case"array":case"object":r[n]=JSON.parse(t[n]);break;default:r[n]=t[n]}else r[n]=e[n].default})),r})(b,r);return(0,e.createElement)(t,{...r,...n})})((({id:t,className:r,title:n,legend:s,description:c,children:a,disabled:o=!1,showStepNumber:l=!0,stepHeadingContent:u=(()=>{})})=>{const d=s||n?"fieldset":"div";return(0,e.createElement)(d,{className:i()(r,"wc-block-components-checkout-step",{"wc-block-components-checkout-step--with-step-number":l,"wc-block-components-checkout-step--disabled":o}),id:t,disabled:o},!(!s&&!n)&&(0,e.createElement)("legend",{className:"screen-reader-text"},s||n),!!n&&(0,e.createElement)(m,{title:n,stepHeadingContent:u()}),(0,e.createElement)("div",{className:"wc-block-components-checkout-step__container"},!!c&&(0,e.createElement)("p",{className:"wc-block-components-checkout-step__description"},c),(0,e.createElement)("div",{className:"wc-block-components-checkout-step__content"},a)))}));var b;const E=(0,c.withInstanceId)((r=>{const s="woocommerce-eu-vat-number",{setValidationErrors:c,clearValidationError:o,getValidationError:d}=r.validation,{cart:m,extensions:b,checkoutExtensionData:E,showStepNumber:f,title:h,description:w}=r,{setExtensionData:_}=E,g=(0,a.getSetting)("woocommerce-eu-vat-number_data"),v="billing_vat_number",k="billing_invoice_ask",S="billing_vat_number_error",T=d(S),{show_nip_field:N,show_ask_field:A,vat_input_label:$,is_required:I,shop_country:L,should_validate:y}=g,[C,x]=(0,e.useState)(b[s]?.billing_invoice_ask),[R,B]=(0,e.useState)(b[s]?.billing_vat_number),Z=I,[F,O]=(0,e.useState)(I);return(0,e.useEffect)((()=>{x(b[s]?.billing_invoice_ask),B(b[s]?.billing_vat_number)}),[b]),(0,e.useEffect)((()=>{_(s,v,R)}),[_,R]),(0,e.useEffect)((()=>{_(s,k,C)}),[_,C]),(0,e.useEffect)((()=>{if(!y||!N)return void o(S);const e=sprintf((0,n.__)("The entered VAT number (%s) is incorrect. Use the following format: %s",s),R,u(m.billingAddress.country));let t=l(m.billingAddress.country,R);R&&!t&&c({[S]:{message:e,hidden:!0}})}),[c,o,C,R,m.billingAddress]),A||N?(0,e.createElement)(p,{id:"shipping-fields",className:i()("wc-block-checkout__shipping-fields","eu-vat-extra-css"),title:$,description:w,showStepNumber:f},(0,e.createElement)("div",null,A&&(0,e.createElement)(t.CheckboxControl,{id:k,checked:C,onChange:e=>{x(e),Z&&O(!0),e||(B(""),O(!1))},label:(0,n.__)("I want an invoice","flexible-invoices"),value:"1"}),N&&(C||!A)&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(t.ValidatedTextInput,{id:v,type:"text",className:!1===T?.hidden?"has-error":"",label:$,value:R,required:F,onChange:e=>{B(e)},onBlur:()=>{y&&(()=>{o(S);let e=l(m.billingAddress.country,R);if(R&&!e){const e=sprintf((0,n.__)("The entered VAT number (%s) is incorrect. Use the following format: %s",s),R,u(m.billingAddress.country));c({[S]:{message:e,hidden:!1}})}})()},customFormatter:e=>e.replace(/[^0-9A-Za-z]/g,"")}),T?.message&&!T?.hidden?(0,e.createElement)("div",{className:"wc-block-components-validation-error",role:"alert"},(0,e.createElement)("p",null,T.message)):null))):(0,e.createElement)(e.Fragment,null)})),f={metadata:{...s,attributes:{...s.attributes,...d({defaultTitle:(0,n.__)("VAT Number","flexible-invoices"),defaultDescription:"",defaultShowStepNumber:!0})}},component:t=>(0,e.createElement)(E,{isEditing:!1,...t})};(0,t.registerCheckoutBlock)(f)})()})();